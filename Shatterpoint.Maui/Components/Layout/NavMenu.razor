@using Shatterpoint.Maui.Services

@inject NavigationService NavigationService;
@inject NavigationManager NavigationManager;

<div class="flex main-color">
    <a class="flex-auto flex @IsSelected(1)" @onclick='() => Navigate("/build")'>
        <img class="units-icon" src="/img/icons/list.png" alt="Menu list" />
    </a>
    <a class="flex-auto flex @IsSelected(2)" @onclick='() => Navigate("/play")'>
        <img class="units-icon" src="/img/icons/cards.png" alt="Menu cards" />
    </a>
    <a class="flex-auto flex @IsSelected(3)" @onclick='() => Navigate("/sandbox")'>
        <div class="units-icon">sandbox</div>
    </a>
</div>
<div class="@GetClass(1)">List Building</div>
<div class="@GetClass(2)">Custom Cards</div>
<div class="@GetClass(3)">Sandbox</div>

@code {
    public int SelectedTab { get; set; } = 1;

    public void Navigate(string destination)
    {
        NavigationService.NavigateFromTo(null, destination);
    }

    protected override void OnInitialized()
    {
        NavigationService.NavigationChanged += OnNavigationChanged;
        base.OnInitialized();
    }


    private void OnNavigationChanged(object sender, NavigationChangedEventArgs args)
    {
        SelectedTab = args.SelectedTab;
    }

    public void Dispose() => NavigationService.NavigationChanged -= OnNavigationChanged;

    public string IsSelected(int selection)
    {
        if (selection == SelectedTab)
            return "tab-selected";
        else
            return "tab-not-selected";
    }

    public string GetClass(int selection)
    {
        if (selection == SelectedTab)
            return "page-title-selected";
        else
            return "page-title";
    }
}